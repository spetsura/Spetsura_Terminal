<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spetsura Notes</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/style.v5.css?v=9999">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    details {
      margin-top: 1.2rem;
      border: 1px solid #3aff3a;
      border-radius: 8px;
      padding: 1rem;
      background-color: #000;
      box-shadow: 0 0 8px #3aff3a40;
    }
    summary {
      cursor: pointer;
      font-weight: bold;
      color: #3aff3a;
    }
    details p {
      margin-top: 0.8rem;
      line-height: 1.5;
    }

    #notes-content details{
      margin-top:1.2rem; border:1px solid #3aff3a; border-radius:8px; padding:1rem;
      background:#000; box-shadow:0 0 8px #3aff3a40;
    }
    #notes-content summary{ cursor:pointer; font-weight:700; color:#3aff3a; outline:none; }
    #notes-content details[open] summary { color:#b8ffb8; }
    #notes-content p{ margin:.4rem 0; line-height:1.5 }
    #notes-content ul{ margin:.4rem 0 .4rem 1.2rem }
    #notes-content code{ padding:0 .2rem; background:#0b0b0b; border:1px solid #3aff3a40; border-radius:4px }
    #notes-content pre{ padding:.6rem; background:#0b0b0b; border:1px solid #3aff3a40; border-radius:8px; overflow:auto }

  </style>
</head>
<body>

<a href="/" id="site-logo">
  <img src="/img/logo.png" alt="Spetsura Logo">
</a>

<main id="site-content">
  <section class="terminal-box notes-spacer">
    <p><span class="prompt">Spetsura@terminal:~$</span> nano site_build_notes.txt</p>

    <div id="notes-content"></div>

    <p class="stack-space"><a href="/" class="cert-link">&larr; Back to main page</a></p>
  </section>
</main>

<script src="/js/marked.min.js"></script>
<script>
  (async () => {
    const root = document.getElementById('notes-content');
    if (!root) return;

    const resp = await fetch('/content/notes.md', { cache: 'no-store' });
    if (!resp.ok) { root.textContent = 'Failed to load notes.md (' + resp.status + ')'; return; }
    const md = await resp.text();

    root.innerHTML = marked.parse(md);

    const children = Array.from(root.childNodes);
    const result = document.createDocumentFragment();
    let i = 0;

    while (i < children.length) {
      const node = children[i];

      if (node.nodeType === 1 && node.tagName === 'H2') {
        const details = document.createElement('details');
        const summary = document.createElement('summary');
        summary.textContent = node.textContent.trim();
        details.appendChild(summary);

        const bodyWrap = document.createElement('div');
        i++;
        while (i < children.length && !(children[i].nodeType === 1 && children[i].tagName === 'H2')) {
          bodyWrap.appendChild(children[i]);
          i++;
        }
        details.appendChild(bodyWrap);

        result.appendChild(details);
      } else {
        result.appendChild(node);
        i++;
      }
    }

    root.innerHTML = '';
    root.appendChild(result);
  })().catch(err => {
    console.error(err);
    const el = document.getElementById('notes-content');
    if (el) el.textContent = 'Error rendering notes.';
  });
</script>

</body>
</html>